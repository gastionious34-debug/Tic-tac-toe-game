<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</title>

<style>
*{box-sizing:border-box}

body{
    font-family:'Segoe UI',Arial,sans-serif;
    background:linear-gradient(135deg,#667eea,#764ba2);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.wrapper{
    display:flex;
    gap:20px;
}

.container{
    width:340px;
    background:#fff;
    padding:20px;
    border-radius:12px;
    box-shadow:0 20px 40px rgba(0,0,0,.2);
}

.side-panel{
    width:220px;
    background:#ffffffcc;
    padding:15px;
    border-radius:12px;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
}

h1,h2{
    text-align:center;
    margin-bottom:10px;
}

p{
    text-align:center;
    font-size:14px;
}

input,select,button{
    width:100%;
    padding:10px;
    margin:6px 0;
    border-radius:6px;
    border:1px solid #ccc;
    font-size:14px;
}

button{
    background:#667eea;
    color:#fff;
    border:none;
    cursor:pointer;
}

.board{
    display:grid;
    grid-template-columns:repeat(3,90px);
    gap:8px;
    justify-content:center;
    margin:15px 0;
}

.cell{
    width:90px;height:90px;
    background:#f5f5f5;
    border-radius:10px;
    font-size:42px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
}

.cell.disabled{
    background:#ddd;
    cursor:default;
}

#status{
    text-align:center;
    margin:8px 0;
    font-size:16px;
}

.player{
    text-align:center;
    font-size:14px;
}

.accounts-list{
    margin-top:10px;
    font-size:14px;
    max-height:300px;
    overflow-y:auto;
}

.accounts-list li{
    margin-bottom:4px;
}

.hidden{display:none}
</style>
</head>
<body>

<div class="wrapper">

<!-- –ò–ì–†–ê / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø -->
<div class="container">

<div id="registerBlock">
    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <p><strong>–Ø –ø—Ä–æ—à—É –ø—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, —á—Ç–æ–±—ã –∑–Ω–∞—Ç—å, –∫—Ç–æ –∏–≥—Ä–∞–µ—Ç –≤ –º–æ—é –∏–≥—Ä—É.</strong></p>
    <input id="firstName" placeholder="–ò–º—è">
    <input id="lastName" placeholder="–§–∞–º–∏–ª–∏—è">
    <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
</div>

<div id="gameBlock" class="hidden">
    <h1>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ üéÆ</h1>

    <div class="player">
        –ò–≥—Ä–æ–∫: <strong id="playerName"></strong>
    </div>

    <select id="difficulty">
        <option value="easy">–õ—ë–≥–∫–∏–π</option>
        <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
        <option value="hard" selected>–°–ª–æ–∂–Ω—ã–π</option>
    </select>

    <div id="status">–í–∞—à —Ö–æ–¥: X</div>

    <div class="board">
        <div class="cell"></div><div class="cell"></div><div class="cell"></div>
        <div class="cell"></div><div class="cell"></div><div class="cell"></div>
        <div class="cell"></div><div class="cell"></div><div class="cell"></div>
    </div>

    <button onclick="resetGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
</div>

</div>

<!-- –ë–û–ö–û–í–ê–Ø –ü–ê–ù–ï–õ–¨ –ê–ö–ö–ê–£–ù–¢–û–í -->
<div class="side-panel">
    <h2>–ê–∫–∫–∞—É–Ω—Ç—ã</h2>
    <div class="accounts-list">
        <ul id="accountsList"></ul>
    </div>
</div>

</div>

<script>
/* ===== –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø ===== */
const registerBlock=document.getElementById('registerBlock');
const gameBlock=document.getElementById('gameBlock');
const playerNameEl=document.getElementById('playerName');
const accountsListEl=document.getElementById('accountsList');

let accounts=JSON.parse(localStorage.getItem('accounts'))||[];
let currentPlayer=localStorage.getItem('player');

renderAccounts();

if(currentPlayer){
    startGame(currentPlayer);
}

function register(){
    const fn=firstName.value.trim();
    const ln=lastName.value.trim();
    if(!fn||!ln)return alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é');

    const fullName=fn+' '+ln;
    localStorage.setItem('player',fullName);

    if(!accounts.includes(fullName)){
        accounts.push(fullName);
        localStorage.setItem('accounts',JSON.stringify(accounts));
    }

    startGame(fullName);
    renderAccounts();
}

function startGame(name){
    registerBlock.classList.add('hidden');
    gameBlock.classList.remove('hidden');
    playerNameEl.textContent=name;
}

function renderAccounts(){
    accountsListEl.innerHTML='';
    accounts.forEach(a=>{
        const li=document.createElement('li');
        li.textContent=a;
        accountsListEl.appendChild(li);
    });
}

/* ===== –ò–ì–†–ê ===== */
const cells=document.querySelectorAll('.cell');
const statusText=document.getElementById('status');
const difficulty=document.getElementById('difficulty');

const HUMAN='X',BOT='O';
let board=Array(9).fill('');
let active=true;

const wins=[
[0,1,2],[3,4,5],[6,7,8],
[0,3,6],[1,4,7],[2,5,8],
[0,4,8],[2,4,6]
];

cells.forEach((c,i)=>c.onclick=()=>humanMove(i));

function humanMove(i){
    if(!active||board[i])return;
    move(i,HUMAN);
    if(end(HUMAN))return;
    statusText.textContent='–•–æ–¥ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞...';
    setTimeout(botMove,300);
}

function botMove(){
    let m;
    const lvl=difficulty.value;

    if(lvl==='easy') m=random();
    else if(lvl==='medium') m=Math.random()<0.5?random():minimax(board,BOT).index;
    else m=Math.random()<0.9?minimax(board,BOT).index:random();

    move(m,BOT);
    end(BOT);
}

function move(i,p){
    board[i]=p;
    cells[i].textContent=p;
    cells[i].classList.add('disabled');
}

function end(p){
    if(wins.some(w=>w.every(i=>board[i]===p))){
        statusText.textContent=p===HUMAN?'–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ':'–ö–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–±–µ–¥–∏–ª ü§ñ';
        active=false;return true;
    }
    if(board.every(Boolean)){
        statusText.textContent='–ù–∏—á—å—è!';
        active=false;return true;
    }
    statusText.textContent='–í–∞—à —Ö–æ–¥: X';
    return false;
}

function random(){
    let e=board.map((v,i)=>v?'':i).filter(v=>v!=='');
    return e[Math.floor(Math.random()*e.length)];
}

function minimax(b,p){
    if(wins.some(w=>w.every(i=>b[i]===HUMAN)))return{score:-10};
    if(wins.some(w=>w.every(i=>b[i]===BOT)))return{score:10};
    let e=b.map((v,i)=>v?'':i).filter(v=>v!=='');
    if(!e.length)return{score:0};

    let m=[];
    for(let i of e){
        b[i]=p;
        let s=minimax(b,p===BOT?HUMAN:BOT).score;
        b[i]='';
        m.push({index:i,score:s});
    }
    return p===BOT?m.reduce((a,b)=>a.score>b.score?a:b):m.reduce((a,b)=>a.score<b.score?a:b);
}

function resetGame(){
    board.fill('');
    cells.forEach(c=>{c.textContent='';c.classList.remove('disabled')});
    active=true;
    statusText.textContent='–í–∞—à —Ö–æ–¥: X';
}
</script>

</body>
</html>
